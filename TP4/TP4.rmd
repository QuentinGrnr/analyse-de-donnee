---
title: "Analyse en Composantes Principales (ACP)"
author: "Analyse R"
date: "`r format(Sys.Date(), '%d %B %Y')`"
output: pdf_document
---

```{r setup, include=FALSE}
library(FactoMineR)
```

# 2 Données fictives
## 2.1 Création des données
```{r}
csp <- as.factor(c("csp3","csp1","csp2","csp2","csp3","csp4"))
sport <- as.factor(c("S","R","R","S","T","T"))
fic.tab <- table(sport,csp)
fic.conting <- data.frame(unclass(fic.tab))
# Paramètres graphiques #
x11()
par(mfrow=c(1,3))
```

## 2.2 AFC de la table de contingence
```{r}
fic.afc <- CA(fic.conting,graph=FALSE)
fic.afc
plot(fic.afc,title="AFC \n classique")
```

## 2.3 AFC du tableau disjonctif complet
```{r}
# Fonction construisant le tableau disjonctif complet #
disj.comp <- function(tab) {
n <- dim(tab)[1]
m <- dim(tab)[2]
ci <- sapply(tab,max)
c <- sum(ci)
disj.tab <- matrix(0,nrow=n,ncol=c)
id <- 0
for (j in 1:m) {
for (i in 1:n) {
disj.tab[i,id + tab[i,j]] <- 1
}
id <- id + ci[j]
}
disj.tab
}
# AFC du tableau disjonctif #
fic.disj.comp <- disj.comp(as.data.frame(cbind(csp,sport)))
colnames(fic.disj.comp) <- c(levels(csp),levels(sport))
fic.disj.afc <- CA(fic.disj.comp,graph=FALSE)
fic.disj.afc
plot(fic.disj.afc,title="AFC \n Tableau Disjonctif")
```

## 2.4 AFC du tableau de Burt
```{r}
fic.burt <- t(fic.disj.comp) %*% fic.disj.comp
fic.burt.afc <- CA(fic.burt,graph=FALSE)
fic.burt.afc
plot(fic.burt.afc,title="AFC \n Tableau de Burt")
```

### **2.4.1 Comparaison des résultats des différentes analyses factorielle des correspondances (AFC)**
Nous allons comparer les résultats obtenus en termes de **valeurs propres** et de **graphique des représentations des individus et des modalités**.

---

#### **2.4.2 AFC de la table de contingence**
- **Chi carré** : 6 (p-value = 0.423)
- **Nombre de catégories** :
- 3 modalités pour la variable "sport" (S, R, T)
- 4 modalités pour la variable "csp" (csp1, csp2, csp3, csp4)
- **Valeurs propres (variance expliquée)** :
- Dim 1 : **75.00%**
- Dim 2 : **25.00%**
- **Interprétation graphique** :
- La première dimension explique la majeure partie de l’inertie.
- Répartition relativement équilibrée des modalités sur le graphique.

---

#### **2.4.3 AFC du tableau disjonctif complet**
- **Chi carré** : 30 (p-value = 0.466)
- **Nombre de catégories** :
- 6 modalités (issues des deux variables combinées)
- 7 colonnes (variables binaires issues du codage disjonctif)
- **Valeurs propres (variance expliquée)** :
- Dim 1 : **37.32%**
- Dim 2 : **30.00%**
- **Interprétation graphique** :
- La première dimension explique moins d'inertie que dans la table de contingence.
- Répartition plus dispersée des modalités, ce qui est attendu car le tableau disjonctif augmente le nombre de dimensions.

---

#### **2.4.4 AFC du tableau de Burt**
- **Chi carré** : 42 (p-value = 0.227)
- **Nombre de catégories** :
- 7 lignes et 7 colonnes
- **Valeurs propres (variance expliquée)** :
- Dim 1 : **49.74%**
- Dim 2 : **32.14%**
- **Interprétation graphique** :
- Inertie de la première dimension plus importante que pour le tableau disjonctif complet.
- Structure plus dense des modalités, car le tableau de Burt est une matrice de produits scalaires entre les modalités.

---

#### **2.4.5 Comparaison et conclusions**
| Méthode              | Dim 1 (%) | Dim 2 (%) | Chi² | p-value |
|----------------------|----------|----------|------|---------|
| **Table de contingence** | **75.00** | **25.00** | 6  | 0.423 |
| **Tableau disjonctif**   | **37.32** | **30.00** | 30 | 0.466 |
| **Tableau de Burt**      | **49.74** | **32.14** | 42 | 0.227 |

**Conclusion** :
- La table de contingence est idéale pour une interprétation simple des relations entre modalités.
- Le tableau disjonctif complet offre plus de détails mais augmente la complexité de l’interprétation.
- Le tableau de Burt donne une vue plus globale des relations entre toutes les modalités.

# 3. Données J.O
```{r}
data(JO)
JO
JO.ca <- CA(JO)
JO.ca
round(JO.ca$eig,2)
barplot(JO.ca$eig[,1],main="Valeurs propres",
        names.arg=paste("dim",1:nrow(JO.ca$eig)))
```
